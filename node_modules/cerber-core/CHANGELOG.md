# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [1.1.4] - 2026-01-04

### Fixed

- **CLI Template Generator**: `--mode` flag now correctly sets mode in generated CERBER.md
  - `npx cerber init --mode=team` now creates template with `mode: team` (not hardcoded `dev`)
  - Applies to solo/dev/team modes
  - Fixed E2E testing workflow

## [1.1.3] - 2026-01-04

### Fixed

#### üêõ CRITICAL: Guardian Validation Logic
- **v1.1.2 shipped with non-functional Guardian** (MVP placeholder that always passed)
- Implemented full forbiddenPatterns validation logic
- Implemented requiredImports checking with architect approval override
- Fixed RegExp serialization issue (using string patterns with flags field)
- Guardian now **actually blocks commits** that violate architecture rules
- Removed debug output from production template

#### ‚úÖ E2E Testing Results
- **TEST 1 PASSED**: Guardian successfully blocks commits with violations
  - Tested with: `const password = "admin123";` 
  - Result: ‚ùå Commit blocked with clear error message
  - Husky pre-commit hook working correctly
  - Fresh install from npm verified

### Breaking Fix
This is technically a BREAKING FIX because v1.1.2 did not enforce any validations. Projects that relied on the previous behavior (no enforcement) will now have commits blocked if they violate patterns defined in BACKEND_SCHEMA.ts.

**Migration**: If you have v1.1.2, upgrade to v1.1.3 immediately. Review and customize your `BACKEND_SCHEMA.ts` patterns before enabling in production.

## [1.1.0] - 2026-01-03

### Added

#### üöÄ Instant Setup Command
- **`npx cerber init`** - One-command project initialization
  - Detects or creates `CERBER.md` with architecture contract
  - Parses machine-readable `CERBER_CONTRACT` (YAML)
  - Generates Guardian hooks, health checks, and CI/CD workflows
  - Supports three modes: `solo`, `dev`, `team`
  - CLI flags: `--mode`, `--force`, `--dry-run`, `--no-husky`, `--no-workflow`, `--no-health`

#### üìã CERBER_CONTRACT Format
- Machine-readable YAML contract embedded in `CERBER.md`
- Defines:
  - `mode`: solo | dev | team
  - `guardian`: pre-commit configuration
  - `health`: runtime health check settings
  - `ci`: GitHub Actions and deployment gates
- Single source of truth for tooling configuration

#### üîß Generated Files
- **Guardian**:
  - `scripts/cerber-guardian.mjs` - Pre-commit validator
  - `.husky/pre-commit` - Git hook
  - Updates `package.json` scripts
- **Health Checks** (optional):
  - `src/cerber/health-checks.ts` - Template checks
  - `src/cerber/health-route.ts` - Express route handler
- **CI/CD**:
  - `.github/workflows/cerber.yml` - GitHub Actions workflow
  - Reusable `cerber-gatekeeper.yml` workflow for post-deploy health
- **Team Mode**:
  - `.github/CODEOWNERS` - Protect architecture files

#### üß™ Testing
- Unit tests for contract parser
- Manual smoke test script
- Dry-run mode for safe testing

#### üìñ Documentation
- New `USAGE_GUIDE.md` with complete setup instructions
- Updated README with 30-second Quick Start
- CERBER_CONTRACT reference documentation

### Changed
- **CLI Version** - Bumped to 1.1.0
- **README.md** - Updated Quick Start section with instant setup
- Template structure organized into `solo/`, `dev/`, `team/` folders

### Security
- All generated files include "Generated by Cerber init" comment
- `--force` flag required to overwrite existing files
- CODEOWNERS template for protecting critical files

---

## [1.0.4] - 2026-01-02

### Changed
- Updated package description with business value messaging
- Enhanced README with "Your Roadmap Becomes Executable Law" section
- Added ROI calculations and cost savings data

---

## [1.0.3] - 2026-01-02

### Changed
- Author metadata updates
- Documentation improvements

---

## [1.0.2] - 2026-01-02

### Fixed
- CI/CD workflow fixes
- Branch protection compatibility

---

## [1.0.1] - 2026-01-02

### Changed
- Initial production release
- Package metadata refinements

---

## [1.0.0] - 2026-01-03

### Added
- **Guardian 1.0**: Pre-commit architecture validator
  - Forbidden pattern detection with architect approval system
  - Required file validation
  - Required import checking
  - package.json rules validation
  - Recursive directory scanning
  - Detailed error/warning reporting
  - CLI with `--schema`, `--verbose`, `--fail-on-warning` options

- **Cerber 2.1**: Runtime health monitoring
  - Flexible health check system
  - Multiple severity levels (critical, error, warning, info)
  - Parallel and sequential check execution
  - Detailed diagnostics with fix suggestions
  - JSON output for CI/CD integration
  - CLI with `--checks`, `--url`, `--parallel` options

- **Architect Approval System**:
  - Comment-based approval format: `// ARCHITECT_APPROVED: reason - YYYY-MM-DD - Name`
  - Automatic parsing and tracking
  - Integration with Guardian validation

- **Examples**:
  - Frontend schema (React/Vue patterns)
  - Backend schema (Node.js/Express patterns)
  - Health check templates (DB, disk, memory, env vars)

- **Documentation**:
  - Comprehensive README with real-world metrics
  - Contributing guidelines
  - API documentation
  - MIT License

- **Production Testing**:
  - Extracted from Eliksir project
  - Real metrics: 18 commits, 43 issues detected, 4.5 hours saved
  - 95% bug detection rate pre-production
  - 2 commits blocked by Guardian

### Technical Details
- TypeScript with ES2022 target
- ESNext modules for modern bundlers
- Commander.js for CLI
- Chalk for colored output
- Full type definitions included
- Zero runtime dependencies (except CLI deps)

## [Unreleased]

### Planned
- Web dashboard for health check visualization
- Slack/Discord notifications
- Custom reporter plugins
- VS Code extension
- Git hooks integration (Husky)
- More built-in health checks
- Performance monitoring
- Metrics export (Prometheus, DataDog)
